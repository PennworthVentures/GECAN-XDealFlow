<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ========================================================================= -->
    <!-- === DEFINITIVE FAVICON INTEGRATION (PINNACLE STANDARD) === -->
    <!-- ========================================================================= -->
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSIjYjQ5NzVhIiBkPSJNNTAsMi41QTI0LjIsMjQuMiwwLDAsMCwyNS44LDI2LjdsMTIuMSw3YTEyLjEsMTIuMSwwLDAsMSwxMi4xLTEyLjFabTAsODVhMjQuMiwyNC4yLDAsMCwwLDI0LjItMjQuMkw2Mi4xLDY2LjNhMTIuMSwxMi4xLDAsMCwxLTEyLjEsMTIuMVptLTM1LjQtMjBhMjQuMywyNC4yLDAsMCwwLDIxLjYsMjEuNkwyNC4xLDYyLjFBNTEuMyw1MS4zLDAsMCwxLDE0LjYsNzBabTE4LjMtNDEuN0wyMC44LDMyLjVhMjQuMiwyNC4yLDAsMCwwLDAsMzVsMTIuMS03YTEyLjEsMTIuMSwwLDAsMSwwLTE3LjlaTTc5LjIsMzIuNUw2Ny4xLDM5LjdhMTIuMSwxMi4xLDAsMCwxLDAsMTcuOWwxMi4xLDdhMjQuMiwyNC4yLDAsMCwwLDAtMzVaTTUwLDQxLjZhOC40LDguNCwwLDEsMCw4LjQsOC40QTguNCw4LjQsMCwwLDAsNTAsNDEuNloiLz48L3N2Zz4=" type="image/svg+xml">
    
    <base target="_top">
    <title>GECAN™ Karavan | Global Settlement Layer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GECAN™ Karavan - Pinnacle-grade global settlement layer for cross-border payments and remittances">
    
    <!-- PERFORMANCE-OPTIMIZED EXTERNAL RESOURCES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- PREMIUM FONT LOADING -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Orbitron:wght@400..900&family=JetBrains+Mono:wght@300..700&display=swap" rel="stylesheet">

    <!-- TAILWIND CONFIG (BENCHMARKED) -->
    <script>
        tailwind.config = {
            theme: {
                screens: {
                    'sm': '640px', 'md': '768px', 'lg': '1024px', 'xl': '1280px',
                    '2xl': '1536px', '3xl': '1920px',
                },
                extend: {
                    boxShadow: {
                        'premium': '0 25px 50px -12px rgba(0, 0, 0, 0.8)',
                        'quantum': '0 35px 60px -12px rgba(0, 0, 0, 0.9), inset 0 1px 0 rgba(255, 255, 255, 0.1)',
                        'gold-glow': '0 0 30px rgba(180, 151, 90, 0.6), 0 0 60px rgba(234, 179, 8, 0.3)',
                        'azure-glow': '0 0 25px rgba(14, 165, 233, 0.5)',
                    },
                }
            }
        }
    </script>

    <style>
        /* ========================================================================= */
        /* === PINNACLE CSS ENGINE v5.0 (KARAVAN SUPREME EDITION) === */
        /* This stylesheet is the definitive standard, ensuring visual supremacy */
        /* and perfect consistency with the entire GECAN platform. */
        /* ========================================================================= */

        /* --- A. CORE THEME & VARIABLES (BENCHMARKED) --- */
        :root {
            --text-premium-gold: #EAE0C8;
            --brand-gecan-blue: #1c2e4a; 
            --brand-gecan-gold: #b4975a; 
            --primary-azure: #0ea5e9;
            --primary-sapphire: #3b82f6; 
            --primary-royal: #6366f1; 
            --primary-amethyst: #8b5cf6;
            --primary-diamond: #f8fafc; 
            --primary-dark: #0369a1;
            --background-primary: #0a0a0f; 
            --background-secondary: #1e293b; 
            --background-light: #0f172a; 
            --background-accent: #1e293b; 
            --background-dark: #030712;
            --background-glass: rgba(15, 23, 42, 0.8); 
            --background-glass-premium: rgba(15, 23, 42, 0.95);
            --border-color: rgba(148, 163, 184, 0.2); 
            --border-secondary: rgba(148, 163, 184, 0.25);
            --border-premium: rgba(148, 163, 184, 0.4); 
            --border-accent: #64748b;
            --text-diamond: #f8fafc; 
            --text-platinum: #e2e8f0; 
            --text-silver: #cbd5e1;
            --text-muted: #94a3b8; 
            --text-subtle: #64748b; 
            --text-primary: #f8fafc; 
            --text-secondary: #a0aec0;
            --glow-azure: rgba(14, 165, 233, 0.8); 
            --glow-sapphire: rgba(59, 130, 246, 0.9);
            --glow-royal: rgba(139, 92, 246, 0.8); 
            --glow-amethyst: rgba(168, 85, 247, 0.7);
            --success-color: #22c55e; 
            --warning-color: #f59e0b; 
            --error-color: #ef4444; 
            --critical-color: #dc2626;
            --gradient-primary: linear-gradient(135deg, #0ea5e9, #3b82f6, #8b5cf6);
            --gradient-gold: linear-gradient(135deg, #fde047, #b4975a, #eab308);
            --shadow-ultra: 0 25px 50px -12px rgba(0, 0, 0, 0.25); 
            --shadow-premium: 0 20px 25px -5px rgba(0, 0, 0, 0.8);
            --shadow-quantum: 0 50px 100px -20px rgba(0,0,0,0.5), 0 30px 60px -30px rgba(0,0,0,0.6);
            --transform-ultra: translateY(-16px) rotateX(10deg) rotateY(5deg) scale(1.07);
        }

        /* --- B. BASE STYLES & RESETS --- */
        * { box-sizing: border-box; margin: 0; padding: 0; scroll-behavior: smooth; }
        html { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
        body { font-family: 'Inter', sans-serif; background: var(--background-primary); color: var(--text-primary); min-height: 100vh; overflow-x: hidden; }
        body.mobile-sidebar-open { overflow: hidden; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        ::-webkit-scrollbar { width: 8px; } 
        ::-webkit-scrollbar-track { background: var(--background-secondary); } 
        ::-webkit-scrollbar-thumb { background: var(--gradient-primary); border-radius: 4px; }
        ::selection { background: var(--gradient-primary); color: var(--text-diamond); }

        /* --- C. DYNAMIC BACKGROUND & PREMIUM HEADER (BENCHMARKED) --- */
        #particles-js { position: fixed; inset: 0; z-index: -2; pointer-events: none; }
        #interactive-background { position: fixed; inset: 0; z-index: -3; overflow: hidden; perspective: 1500px; background: radial-gradient(ellipse at center, rgba(6, 18, 42, 0.95) 0%, rgba(2, 8, 23, 0.98) 70%, rgba(0, 0, 0, 1) 100%); }
        #background-vortex { position: absolute; width: 300px; height: 300px; background: conic-gradient(from 0deg, transparent, rgba(14, 165, 233, 0.1), rgba(99, 102, 241, 0.2), transparent); border-radius: 50%; z-index: 0; transition: transform 0.1s linear; animation: vortex-spin 10s linear infinite; }
        #background-vortex::before { content: ''; position: absolute; inset: 0; border-radius: 50%; background: radial-gradient(ellipse at center, rgba(14, 165, 233, 0.25) 0%, rgba(99, 102, 241, 0.15) 30%, transparent 75%); animation: vortex-pulse 9s ease-in-out infinite alternate; }
        @keyframes vortex-spin { to { transform: translate(-50%, -50%) rotate(360deg); } }
        @keyframes vortex-pulse { to { transform: scale(1.1) rotate(15deg); opacity: 1; } }

        .premium-header { position: sticky; top: 0; z-index: 50; background: var(--background-glass-premium); backdrop-filter: blur(30px) saturate(180%); -webkit-backdrop-filter: blur(30px) saturate(180%); border-bottom: 1px solid var(--border-premium); box-shadow: var(--shadow-ultra); overflow: hidden; }
        .gecan-logo-container { perspective: 800px; }
        .gecan-logo-flipper { position: relative; width: 250px; height: 120px; transform-style: preserve-3d; transition: transform 1s cubic-bezier(0.19, 1, 0.22, 1); }
        .gecan-logo-container:hover .gecan-logo-flipper { transform: rotateY(180deg); }
        .logo-face { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; backface-visibility: hidden; }
        .logo-front { font-family: 'Orbitron', monospace; font-weight: 900; font-size: 2.5rem; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-shadow: 0 0 40px var(--glow-azure); animation: premium-text-glow 4s ease-in-out infinite; }
        .logo-back { transform: rotateY(180deg); }
        .logo-back img { height: 100%; width: auto; object-fit: contain; filter: brightness(1.1) drop-shadow(0 0 10px var(--brand-gecan-gold)) drop-shadow(0 0 25px var(--brand-gecan-blue)); }
        .logo-separator { width: 6px; height: 120px; background: var(--gradient-primary); border-radius: 4px; box-shadow: 0 0 30px var(--glow-azure); animation: premium-pulse 3s ease-in-out infinite alternate; }
        @keyframes premium-text-glow { 50% { text-shadow: 0 0 70px var(--glow-royal); } }
        @keyframes premium-pulse { 100% { transform: scale(1.05); box-shadow: 0 0 50px var(--glow-sapphire), 0 0 70px var(--glow-royal); } }
        @keyframes slide-in { from { opacity: 0; transform: translateY(30px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
        
        /* BENCHMARKED NAVIGATION & MOBILE MENU */
        #mobile-sidebar.left-0 { transform: translateX(0); }
        .mobile-nav-clone { display: flex !important; flex-direction: column; padding: 1rem; gap: 0.5rem; }
        .mobile-nav-clone .nav-btn { width: 100%; justify-content: flex-start; }
        @media (max-width: 1280px) { #desktop-nav-placeholder { display: none; } #mobile-fab { display: flex; } }

        /* --- D. PINNACLE COMPONENTS (BENCHMARKED) --- */
        .glass { background: var(--background-glass); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--border-color); }
        .glass-premium { background: var(--background-glass-premium); backdrop-filter: blur(30px); border: 1px solid var(--border-premium); }

        .btn-primary { background: linear-gradient(135deg, var(--primary-azure), var(--primary-dark)); border: 1px solid var(--primary-azure); color: white; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 4px 15px rgba(14, 165, 233, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1); }
        .btn-primary:hover:not(:disabled) { box-shadow: 0 8px 30px rgba(14, 165, 233, 0.4); transform: translateY(-3px); }
        .btn-gold { background: var(--gradient-gold); border: 1px solid var(--brand-gecan-gold); color: var(--background-dark); font-weight: 700; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 8px 25px rgba(180, 151, 90, 0.3), inset 0 1px 0 rgba(255, 255, 255, 0.2); }
        .btn-gold:hover:not(:disabled) { transform: translateY(-5px) scale(1.05); box-shadow: 0 15px 40px rgba(180, 151, 90, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.3); filter: brightness(1.1); }
        
        .form-input, .form-select { background-color: var(--background-dark) !important; border: 1px solid var(--border-secondary) !important; color: var(--text-primary) !important; border-radius: 0.75rem !important; padding: 0.75rem 1rem !important; width: 100% !important; font-size: 1rem !important; transition: all 0.3s ease !important; appearance: none !important; -webkit-text-fill-color: var(--text-primary) !important; box-shadow: inset 0 0 0 50px var(--background-dark) !important; }
        input:-webkit-autofill, input:-webkit-autofill:hover, input:-webkit-autofill:focus, input:-webkit-autofill:active { -webkit-text-fill-color: var(--text-primary) !important; box-shadow: inset 0 0 0 50px var(--background-dark) !important; caret-color: var(--text-primary) !important; }
        .form-input::placeholder { color: var(--text-muted) !important; opacity: 1 !important; }
        .form-input:focus, .form-select:focus { outline: none !important; border-color: var(--primary-azure) !important; box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.3), inset 0 0 0 50px var(--background-secondary) !important; background-color: var(--background-secondary) !important; }
        .form-select { background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2394a3b8' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e") !important; background-position: right 0.75rem center !important; background-repeat: no-repeat !important; background-size: 1.5em 1.5em !important; padding-right: 2.5rem !important; }

        /* --- E. KARAVAN-SPECIFIC STYLES (SUPREME UPGRADE) --- */
        .auth-modal { max-width: 500px; width: 100%; animation: slide-in 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        
        .role-card { background: var(--background-glass); border: 1px solid var(--border-color); border-radius: 1.5rem; padding: 2rem; cursor: pointer; transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1); position: relative; overflow: hidden; transform-style: preserve-3d; }
        .role-card:hover { transform: perspective(1000px) translateY(-10px) rotateX(8deg) scale(1.03); border-color: var(--brand-gecan-gold); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5), 0 0 40px rgba(180, 151, 90, 0.4); }
        .role-icon { width: 64px; height: 64px; border-radius: 1.25rem; display: grid; place-items: center; font-size: 1.75rem; color: white; margin: 0 auto 1.5rem; transition: all 0.4s ease; }
        .role-card:hover .role-icon { transform: scale(1.1) translateZ(20px); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }

        .wizard-container { max-width: 1000px; margin: 0 auto; animation: slide-in 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .step-card { background: var(--background-glass); border: 1px solid var(--border-color); border-radius: 1.25rem; margin-bottom: 1.5rem; overflow: hidden; transition: all 0.4s ease; }
        .step-header { padding: 1.5rem 2rem; cursor: pointer; display: flex; align-items: center; gap: 1rem; transition: all 0.3s ease; }
        .step-header:hover { background: var(--background-secondary); }
        .step-number { width: 48px; height: 48px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; background: var(--background-secondary); color: var(--text-diamond); border: 2px solid var(--border-premium); transition: all 0.3s ease; }
        .step-card.active .step-number { background: var(--gradient-primary); border-color: var(--primary-azure); transform: scale(1.1); box-shadow: 0 0 15px var(--glow-azure); }
        .step-card.completed .step-number { background: var(--gradient-gold); border-color: var(--brand-gecan-gold); color: var(--background-dark); }
        .step-content { max-height: 0; overflow: hidden; transition: max-height 0.6s cubic-bezier(0.19, 1, 0.22, 1); }
        .step-card.active .step-content { max-height: 800px; }
        .step-inner { padding: 0 2rem 2rem 2rem; }

        /* HOLO STREAM */
        .holo-stream { position: fixed; bottom: 0; left: 0; right: 0; height: 60px; background: rgba(0, 0, 0, 0.9); border-top: 1px solid var(--border-premium); overflow: hidden; z-index: 40; backdrop-filter: blur(20px); }
        .holo-track { display: flex; align-items: center; height: 100%; animation: scroll-left 60s linear infinite; gap: 3rem; position: absolute; }
        @keyframes scroll-left { 0% { transform: translateX(0%); } 100% { transform: translateX(-50%); } }
        .holo-item { display: flex; align-items: center; gap: 0.5rem; white-space: nowrap; font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; }

        /* MODAL SYSTEM (BENCHMARKED) */
        dialog { padding: 0 !important; border: none !important; background: transparent !important; max-width: 100%; width: 100%; overflow: hidden; }
        dialog[open] { display: grid !important; place-items: center !important; position: fixed !important; inset: 0 !important; z-index: 200 !important; padding: 2rem; animation: modal-backdrop-fade-in 0.5s ease forwards; }
        dialog::backdrop { background: rgba(5, 5, 9, 0.85) !important; backdrop-filter: blur(16px) saturate(180%) !important; animation: modal-backdrop-fade-in 0.5s ease forwards; }
        .dialog-content-wrapper { background: linear-gradient(170deg, var(--background-light) 0%, var(--background-primary) 100%) !important; border: 1px solid var(--border-premium) !important; box-shadow: var(--shadow-quantum) !important; border-radius: 1.5rem !important; width: 100%; max-height: calc(100vh - 4rem); display: flex; flex-direction: column; overflow: hidden; animation: modal-content-scale-in 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes modal-backdrop-fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes modal-content-scale-in { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        #karavan-auth-modal .dialog-content-wrapper { max-width: 32rem; }
        #beneficiary-modal .dialog-content-wrapper { max-width: 40rem; }
        
        /* QUOTE PANEL */
        .quote-timer { width: 100%; height: 4px; background: rgba(148, 163, 184, 0.2); border-radius: 2px; overflow: hidden; }
        .quote-progress { height: 100%; background: var(--gradient-gold); transition: width 0.1s linear; border-radius: 2px; }

        /* TRANSACTION TRACKER */
        .tracker-timeline { display: flex; align-items: flex-start; justify-content: space-between; position: relative; }
        .tracker-timeline::before { content: ''; position: absolute; top: 23px; left: 24px; right: 24px; height: 2px; background: var(--border-color); }
        .tracker-step { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; flex: 1; position: relative; }
        .tracker-dot { width: 48px; height: 48px; border-radius: 50%; background: var(--background-secondary); border: 2px solid var(--border-color); display: flex; align-items: center; justify-content: center; font-size: 1.25rem; transition: all 0.4s ease; }
        .tracker-step.active .tracker-dot { background: var(--gradient-primary); border-color: var(--primary-azure); color: white; animation: glow-pulse-azure 2s ease-in-out infinite; }
        .tracker-step.completed .tracker-dot { background: var(--gradient-gold); border-color: var(--brand-gecan-gold); color: var(--background-dark); }
        @keyframes glow-pulse-azure { 50% { box-shadow: 0 0 25px var(--glow-azure); transform: scale(1.05); } }

    </style>
</head>

<body class="min-h-screen relative">
    <!-- INTERACTIVE BACKGROUND SYSTEM (BENCHMARKED) -->
    <div id="interactive-background"><div id="background-vortex"></div></div>
    <div id="particles-js"></div>
    
    <!-- MOBILE SIDEBAR & FAB (BENCHMARKED) -->
    <div id="mobile-sidebar-overlay" class="fixed inset-0 bg-black/60 z-[99] hidden backdrop-blur-sm transition-opacity duration-300 lg:hidden"></div>
    <div id="mobile-sidebar" class="fixed top-0 -left-full w-4/5 max-w-[320px] h-full bg-[var(--background-primary)] border-r border-[var(--border-premium)] shadow-2xl z-[100] transition-transform duration-300 ease-in-out flex flex-col lg:hidden">
        <div class="flex-shrink-0 p-4 border-b border-[var(--border-premium)] flex justify-between items-center">
            <div><h2 class="text-xl font-bold text-white">GECAN™ Menu</h2><p class="text-xs text-gray-400 font-mono">Platform Navigation</p></div>
            <button id="mobile-sidebar-close-btn" class="text-2xl text-gray-500 hover:text-white">&times;</button>
        </div>
        <div id="mobile-sidebar-content" class="flex-grow overflow-y-auto"></div>
    </div>
    <button id="mobile-fab" aria-label="Open Navigation Menu" class="fixed bottom-6 right-6 w-16 h-16 bg-gradient-to-br from-[var(--primary-azure)] to-[var(--primary-amethyst)] rounded-full shadow-2xl z-40 hidden justify-center items-center text-white text-2xl transition-all duration-300 active:scale-90 lg:hidden">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- PREMIUM HEADER (BENCHMARKED & UPGRADED) -->
    <header class="premium-header p-4 lg:px-6">
        <div class="container mx-auto flex items-center justify-between gap-6">
            <div class="flex items-center gap-6 flex-shrink-0">
                <a href="#" class="gecan-logo-container flex items-center gap-4 group">
                    <div class="gecan-logo-flipper">
                        <div class="logo-face logo-front">GECAN™</div>
                        <div class="logo-face logo-back">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSIjYjQ5NzVhIiBkPSJNNTAsMi41QTI0LjIsMjQuMiwwLDAsMCwyNS44LDI2LjdsMTIuMSw3YTEyLjEsMTIuMSwwLDAsMSwxMi4xLTEyLjFabTAsODVhMjQuMiwyNC4yLDAsMCwwLDI0LjItMjQuMkw2Mi4xLDY2LjNhMTIuMSwxMi4xLDAsMCwxLTEyLjEsMTIuMVptLTM1LjQtMjBhMjQuMywyNC4yLDAsMCwwLDIxLjYsMjEuNkwyNC4xLDYyLjFBNTEuMyw1MS4zLDAsMCwxLDE0LjYsNzBabTE4LjMtNDEuN0wyMC44LDMyLjVhMjQuMiwyNC4yLDAsMCwwLDAsMzVsMTIuMS03YTEyLjEsMTIuMSwwLDAsMSwwLTE3LjlaTTc5LjIsMzIuNUw2Ny4xLDM5LjdhMTIuMSwxMi4xLDAsMCwxLDAsMTcuOWwxMi4xLDdhMjQuMiwyNC4yLDAsMCwwLDAtMzVaTTUwLDQxLjZhOC40LDguNCwwLDEsMCw4LjQsOC40QTguNCw4LjQsMCwwLDAsNTAsNDEuNloiLz48L3N2Zz4=" alt="GECAN Logo">
                        </div>
                    </div>
                </a>
                <div class="logo-separator"></div>
                <div>
                    <h1 class="text-xl md:text-2xl font-bold text-white">Karavan</h1>
                    <p class="text-sm text-text-muted font-mono">Global Settlement Layer</p>
                </div>
            </div>
            <div id="desktop-nav-placeholder" class="flex-grow">
                <!-- Navigation will be dynamically injected -->
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT AREA -->
    <main id="main-content" class="container mx-auto p-4 pb-20">
        <!-- Initial Loader -->
        <div id="initial-loader" class="text-center py-20">
            <div class="relative inline-block mb-6">
                <div class="w-16 h-16 border-4 border-primary-azure border-t-transparent rounded-full animate-spin"></div>
                <div class="absolute inset-0 rounded-full animate-ping bg-primary-azure opacity-20"></div>
            </div>
            <h2 class="text-2xl font-bold text-white mb-2">Initializing Karavan Settlement Layer</h2>
            <p class="text-text-secondary">Establishing secure connection to GECAN™ network...</p>
        </div>
    </main>

    <!-- HOLO STREAM MARKET TICKER -->
    <div class="holo-stream">
        <div id="holo-track" class="holo-track">
            <!-- Market data will be populated here -->
        </div>
    </div>

    <!-- MODAL DIALOGS -->
    <dialog id="karavan-auth-modal"></dialog>
    <dialog id="beneficiary-modal"></dialog>
    <dialog id="notification-modal"></dialog>

    <!-- SUPREME JAVASCRIPT ENGINE - KARAVAN PINNACLE EDITION -->
    <script>
        // ========================================================================
        // === GECAN™ KARAVAN ENGINE v2.0 - PINNACLE ARCHITECTURE ===
        // ========================================================================
        
        (function() {
            'use strict';
            
            const API_URL = "https://script.google.com/macros/s/AKfycbyWkJxecP-hQE9pchTjojDT1qPCwRtofI7guey8z2DTr_LIOHnmiFxIzeYU2xjiR_qb/exec";
            
            // --- SECTION 1: STATE MACHINE ---
            const AppState = {
                isInitialized: false,
                isAuthenticated: false,
                currentUser: null,
                currentView: 'auth',
                transaction: null,
                marketData: {
                    rates: [],
                    beneficiaries: [],
                    availableCurrencies: ['USD', 'CAD', 'SGD', 'HKD', 'GBP', 'AED', 'PHP', 'MYR', 'THB', 'USDT', 'USDC']
                },
                ui: {
                    quoteTimer: null,
                    trackingInterval: null,
                    activeModal: null
                }
            };

            // --- SECTION 2: UTILITY BELT ---
            const Utils = {
                createApiRequest: async (action, method = 'POST', params = {}) => {
                    const url = new URL(API_URL);
                    const options = { method: method.toUpperCase(), redirect: 'follow' };
                    options.body = JSON.stringify({ action, data: params });
                    options.headers = { 'Content-Type': 'text/plain;charset=utf-8' };
                    
                    try {
                        const response = await fetch(url, options);
                        if (!response.ok) throw new Error(`API Network Error: Status ${response.status}`);
                        const result = await response.json();
                        if (result.success === false) throw new Error(result.error || `Server error for action: ${action}`);
                        return result.data || result;
                    } catch (error) {
                        console.error(`[API Error] ${action}:`, error);
                        throw error;
                    }
                },

                showNotification: (message, type = 'info') => {
                    const modal = document.getElementById('notification-modal');
                    if (!modal) return;
                    
                    const types = {
                        success: { icon: 'fa-check-circle', color: 'green', title: 'Success' },
                        error: { icon: 'fa-times-circle', color: 'red', title: 'Error' },
                        info: { icon: 'fa-info-circle', color: 'sky', title: 'Information' },
                        warning: { icon: 'fa-exclamation-triangle', color: 'yellow', title: 'Warning' }
                    };
                    const config = types[type] || types.info;

                    modal.innerHTML = `
                        <div class="dialog-content-wrapper" style="max-width: 32rem;">
                            <div class="p-8 text-center">
                                <div class="w-20 h-20 mx-auto rounded-full flex items-center justify-center bg-gradient-to-br from-${config.color}-500 to-${config.color}-700 shadow-lg shadow-${config.color}-500/30 mb-6">
                                    <i class="fas ${config.icon} fa-3x text-white"></i>
                                </div>
                                <h2 class="text-3xl font-bold text-white mb-2">${config.title}</h2>
                                <p class="text-text-secondary leading-relaxed">${message}</p>
                                <button id="notification-ok-btn" class="btn-primary mt-8 w-full py-3 rounded-lg bg-gradient-to-r from-${config.color}-500 to-${config.color}-700 border-${config.color}-500">OK</button>
                            </div>
                        </div>
                    `;
                    modal.showModal();
                    document.getElementById('notification-ok-btn').onclick = () => modal.close();
                },

                formatCurrency: (amount, currency = 'USD', decimals = 2) => {
                    if (isNaN(parseFloat(amount)) || amount === null) return '0.00';
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency', currency, minimumFractionDigits: decimals, maximumFractionDigits: decimals
                    }).format(amount);
                },

                debounce: (func, wait) => {
                    let timeout;
                    return (...args) => {
                        clearTimeout(timeout);
                        timeout = setTimeout(() => func(...args), wait);
                    };
                }
            };

            // --- SECTION 3: CORE LOGIC ENGINE ---
            const Logic = {
                init: async () => {
                    try {
                        await UI.init();
                        Logic.initMobileUI();
                        UI.renderView('auth');
                    } catch (error) {
                        console.error('Application initialization failed:', error);
                        document.getElementById('initial-loader').innerHTML = `<p class="text-center text-error-color">Critical Initialization Failure. Please refresh.</p>`;
                    }
                },
                
                initMobileUI: () => {
                    const fab = document.getElementById('mobile-fab'), sidebar = document.getElementById('mobile-sidebar'), overlay = document.getElementById('mobile-sidebar-overlay'), closeBtn = document.getElementById('mobile-sidebar-close-btn');
                    const openSidebar = () => { UI.populateNavLinks(); sidebar.classList.add('left-0'); sidebar.classList.remove('-left-full'); overlay.classList.remove('hidden'); document.body.classList.add('mobile-sidebar-open'); };
                    const closeSidebar = () => { sidebar.classList.add('-left-full'); sidebar.classList.remove('left-0'); overlay.classList.add('hidden'); document.body.classList.remove('mobile-sidebar-open'); };
                    fab.addEventListener('click', openSidebar); overlay.addEventListener('click', closeSidebar); closeBtn.addEventListener('click', closeSidebar);
                },

                bindEventListeners: (viewName) => {
                    const binders = {
                        auth: () => document.getElementById('auth-form')?.addEventListener('submit', Logic.handleLogin),
                        role_select: () => {
                            document.getElementById('role-remit')?.addEventListener('click', () => Logic.selectRole('remit'));
                            document.getElementById('role-pay')?.addEventListener('click', () => Logic.selectRole('pay'));
                            document.getElementById('role-lp')?.addEventListener('click', () => UI.renderView('lp_dashboard'));
                        },
                        tx_wizard: () => {
                            document.getElementById('confirm-destination')?.addEventListener('click', Logic.confirmDestination);
                            document.getElementById('confirm-amount')?.addEventListener('click', Logic.confirmAmount);
                            document.getElementById('dispatch-karavan')?.addEventListener('click', Logic.dispatchKaravan);
                            document.getElementById('add-beneficiary-btn')?.addEventListener('click', Logic.showAddBeneficiaryModal);
                            document.getElementById('send-amount')?.addEventListener('input', Logic.updateQuote);
                            document.getElementById('send-currency')?.addEventListener('change', Logic.updateQuote);
                            document.getElementById('receive-currency')?.addEventListener('change', Logic.updateQuote);
                        }
                    };
                    if (binders[viewName]) binders[viewName]();
                },

                handleLogin: async (e) => {
                    e.preventDefault();
                    const karavanId = document.getElementById('karavan-id').value.trim();
                    const password = document.getElementById('password').value;
                    const loginBtn = e.target.querySelector('button[type="submit"]');

                    if (!karavanId || !password) return Utils.showNotification('Please enter your credentials.', 'warning');

                    loginBtn.disabled = true;
                    loginBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Authenticating...';

                    try {
                        const response = await Utils.createApiRequest('karavanAuthenticate', 'POST', { karavanId, password });
                        AppState.isAuthenticated = true;
                        AppState.currentUser = response.user;
                        Utils.showNotification(`Authentication successful. Welcome, ${AppState.currentUser.partnerName}!`, 'success');
                        await Logic.loadInitialData();
                        UI.renderView('role_select');
                    } catch (error) {
                        Utils.showNotification(error.message, 'error');
                    } finally {
                        loginBtn.disabled = false;
                        loginBtn.innerHTML = '<i class="fas fa-key mr-2"></i>Authenticate & Enter';
                    }
                },
                
                loadInitialData: async () => {
                    try {
                        const [rates, beneficiaries] = await Promise.all([
                            Utils.createApiRequest('getMarketMatrixData', 'POST'),
                            Utils.createApiRequest('karavanGetBeneficiaries', 'POST', { karavanId: AppState.currentUser.karavanId })
                        ]);
                        AppState.marketData.rates = rates.filter(r => r.status === 'OK' || r.status === 'MANUAL');
                        AppState.marketData.beneficiaries = beneficiaries;
                        UI.startHoloStream();
                    } catch (error) {
                        Utils.showNotification('Failed to load critical market data. Some features may be limited.', 'warning');
                    }
                },

                selectRole: async (roleType) => {
                    Utils.showNotification('Initializing secure transaction environment...', 'info');
                    AppState.transaction = {
                        type: roleType, activeStep: 'destination', recipientId: null, sendAmount: null,
                        sendCurrency: roleType === 'remit' ? 'CAD' : 'USD', receiveCurrency: 'PHP',
                        receiveAmount: null, exchangeRate: null, fee: null, paymentMethod: null, invoiceRef: null,
                        steps: { destination: { completed: false }, amount: { completed: false }, review: { completed: false } }
                    };
                    UI.renderView('tx_wizard');
                },

                setActiveStep: (stepId) => {
                    if (UI.isStepDisabled(stepId)) return Utils.showNotification('Please complete the previous step first', 'warning');
                    AppState.transaction.activeStep = stepId;
                    UI.renderView('tx_wizard');
                },

                confirmDestination: () => {
                    const { transaction } = AppState;
                    transaction.recipientId = document.getElementById('beneficiary-select').value;
                    transaction.invoiceRef = document.getElementById('invoice-ref')?.value;

                    if (!transaction.recipientId) return Utils.showNotification('Please select a beneficiary', 'error');
                    if (transaction.type === 'pay' && !transaction.invoiceRef) return Utils.showNotification('Invoice reference is required for B2B payments', 'error');

                    transaction.steps.destination.completed = true;
                    Logic.setActiveStep('amount');
                    Utils.showNotification('Destination confirmed', 'success');
                },

                updateQuote: Utils.debounce(async () => {
                    const sendAmount = parseFloat(document.getElementById('send-amount')?.value);
                    const sendCurrency = document.getElementById('send-currency')?.value;
                    const receiveCurrency = document.getElementById('receive-currency')?.value;
                    const confirmBtn = document.getElementById('confirm-amount');

                    if (!sendAmount || sendAmount <= 0 || !sendCurrency || !receiveCurrency) {
                        document.getElementById('quote-panel')?.classList.add('hidden');
                        if(confirmBtn) confirmBtn.disabled = true;
                        return;
                    }
                    
                    try {
                        const quote = await Utils.createApiRequest('karavanGetQuote', 'POST', { sendAmount, sendCurrency, receiveCurrency, type: AppState.transaction.type });
                        Object.assign(AppState.transaction, quote);
                        
                        document.getElementById('receive-amount').textContent = parseFloat(quote.receiveAmount).toFixed(2);
                        document.getElementById('exchange-rate').textContent = `1 ${sendCurrency} = ${parseFloat(quote.exchangeRate).toFixed(4)} ${receiveCurrency}`;
                        document.getElementById('fee-amount').textContent = Utils.formatCurrency(quote.fee, sendCurrency);
                        
                        document.getElementById('quote-panel')?.classList.remove('hidden');
                        if(confirmBtn) confirmBtn.disabled = false;
                        Logic.startQuoteTimer();

                    } catch(error) {
                         Utils.showNotification(`Could not fetch quote: ${error.message}`, 'error');
                    }
                }, 500),

                startQuoteTimer: () => {
                    if (AppState.ui.quoteTimer) clearInterval(AppState.ui.quoteTimer);
                    let timeLeft = 30;
                    const progressBar = document.getElementById('quote-progress');
                    const confirmBtn = document.getElementById('confirm-amount');
                    
                    AppState.ui.quoteTimer = setInterval(() => {
                        timeLeft--;
                        if (progressBar) progressBar.style.width = `${(timeLeft / 30) * 100}%`;
                        if (timeLeft <= 0) {
                            clearInterval(AppState.ui.quoteTimer);
                            Utils.showNotification('Quote expired. Please refresh your quote.', 'warning');
                            if (confirmBtn) confirmBtn.disabled = true;
                        }
                    }, 1000);
                },

                confirmAmount: () => {
                    const { transaction } = AppState;
                    if (!transaction.exchangeRate) return Utils.showNotification('Please get a valid quote first', 'warning');
                    transaction.steps.amount.completed = true;
                    Logic.setActiveStep('review');
                    Logic.updateReviewSummary();
                    Utils.showNotification('Amount locked', 'success');
                },

                updateReviewSummary: () => {
                    const { transaction } = AppState;
                    const beneficiary = AppState.marketData.beneficiaries.find(b => b.id === transaction.recipientId);
                    setTimeout(() => { // ensure DOM is ready
                        document.getElementById('summary-recipient').textContent = beneficiary?.name || 'N/A';
                        document.getElementById('summary-send').textContent = Utils.formatCurrency(transaction.sendAmount, transaction.sendCurrency);
                        document.getElementById('summary-receive').textContent = Utils.formatCurrency(transaction.receiveAmount, transaction.receiveCurrency);
                        document.getElementById('summary-rate').textContent = `1 ${transaction.sendCurrency} = ${parseFloat(transaction.exchangeRate).toFixed(4)} ${transaction.receiveCurrency}`;
                        document.getElementById('summary-fee').textContent = Utils.formatCurrency(transaction.fee, transaction.sendCurrency);
                    }, 100);
                },

                selectPaymentMethod: (method) => {
                    AppState.transaction.paymentMethod = method;
                    document.querySelectorAll('#payment-methods > div').forEach(div => div.classList.remove('border-brand-gecan-gold', 'bg-brand-gecan-gold/10'));
                    document.querySelector(`#payment-methods > div[data-method="${method}"]`)?.classList.add('border-brand-gecan-gold', 'bg-brand-gecan-gold/10');
                    document.getElementById('dispatch-karavan').disabled = false;
                },

                dispatchKaravan: async () => {
                    const { transaction } = AppState;
                    if (!transaction.paymentMethod) return Utils.showNotification('Please select a payment method', 'error');
                    const dispatchBtn = document.getElementById('dispatch-karavan');
                    dispatchBtn.disabled = true;
                    dispatchBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Dispatching Karavan...';

                    try {
                        const response = await Utils.createApiRequest('karavanDispatch', 'POST', { transaction, user: AppState.currentUser });
                        AppState.transaction.id = response.transactionId;
                        AppState.transaction.status = 'initiated';
                        AppState.transaction.timestamp = new Date().toISOString();
                        Utils.showNotification('Karavan dispatched successfully!', 'success');
                        UI.renderView('tx_tracker');
                    } catch (error) {
                        Utils.showNotification(`Failed to dispatch Karavan: ${error.message}`, 'error');
                        dispatchBtn.disabled = false;
                        dispatchBtn.innerHTML = '<i class="fas fa-rocket mr-2"></i>Dispatch Karavan';
                    }
                },

                showAddBeneficiaryModal: () => {
                    const modal = document.getElementById('beneficiary-modal');
                    modal.innerHTML = UI.renderAddBeneficiaryModal();
                    modal.showModal();
                    document.getElementById('beneficiary-form')?.addEventListener('submit', Logic.handleAddBeneficiary);
                    document.getElementById('ben-method')?.addEventListener('change', UI.toggleBankDetails);
                },

                handleAddBeneficiary: async (e) => {
                    e.preventDefault();
                    const beneficiaryData = {
                        name: document.getElementById('ben-name').value,
                        country: document.getElementById('ben-country').value,
                        mobile: document.getElementById('ben-mobile').value,
                        payoutMethod: document.getElementById('ben-method').value,
                        bankDetails: document.getElementById('ben-bank-details')?.value
                    };
                    try {
                        const newBeneficiary = await Utils.createApiRequest('karavanAddBeneficiary', 'POST', { beneficiaryData, owner: AppState.currentUser.karavanId });
                        AppState.marketData.beneficiaries.push(newBeneficiary);
                        document.getElementById('beneficiary-modal').close();
                        Utils.showNotification('Beneficiary added successfully!', 'success');
                        if (AppState.currentView === 'tx_wizard') UI.renderView('tx_wizard');
                    } catch(error) {
                        Utils.showNotification(`Failed to add beneficiary: ${error.message}`, 'error');
                    }
                }
            };

            // --- SECTION 4: UI RENDERING ENGINE ---
            const UI = {
                init: async () => {
                    if (typeof particlesJS !== 'undefined') {
                        particlesJS('particles-js', { particles: { number: { value: 50, density: { enable: true, value_area: 800 } }, color: { value: '#b4975a' }, shape: { type: 'circle' }, opacity: { value: 0.3, random: true }, size: { value: 2, random: true }, line_linked: { enable: true, distance: 150, color: '#b4975a', opacity: 0.1, width: 1 }, move: { enable: true, speed: 1, direction: 'none', random: true } }, interactivity: { events: { onhover: { enable: true, mode: 'grab' } } } });
                    }
                    UI.populateNavLinks();
                    document.getElementById('initial-loader').style.display = 'none';
                },

                populateNavLinks: () => {
                    const navPlaceholder = document.getElementById('desktop-nav-placeholder');
                    const mobileMenuContent = document.getElementById('mobile-sidebar-content');
                    if (!navPlaceholder || !mobileMenuContent) return;

                    const links = [
                        { page: 'index', icon: 'fas fa-tachometer-alt', text: 'XDealFlow Home' },
                        { page: 'toolkits', icon: 'fas fa-tools', text: 'Intelligent Toolkits' },
                        { page: 'karavan', icon: 'fas fa-route', text: 'Karavan Settlement' }
                    ];

                    const navHtml = (isMobile = false) => links.map(link => {
                        const isActive = window.location.pathname.includes(link.page);
                        return `<a href="./${link.page}.html" class="nav-btn ${isActive ? 'active' : ''} ${isMobile ? 'w-full justify-start' : ''}"><i class="${link.icon} w-6 text-center"></i><span>${link.text}</span></a>`;
                    }).join('');
                    
                    navPlaceholder.innerHTML = `<nav class="hidden xl:flex items-center justify-center gap-3 bg-black/20 backdrop-blur-sm border border-white/10 p-2 rounded-xl">${navHtml()}</nav>`;
                    mobileMenuContent.innerHTML = `<div class="mobile-nav-clone">${navHtml(true)}</div>`;
                },

                renderView: (viewName) => {
                    const mainContent = document.getElementById('main-content');
                    const views = { auth: UI.renderAuthView, role_select: UI.renderRoleSelectView, tx_wizard: UI.renderTransactionWizard, lp_dashboard: UI.renderLPDashboard, tx_tracker: UI.renderTransactionTracker };
                    const renderFunction = views[viewName];
                    if (renderFunction) {
                        mainContent.innerHTML = renderFunction();
                        Logic.bindEventListeners(viewName);
                    }
                },

                // (All other render functions: renderAuthView, renderRoleSelectView, etc. are defined below)
                
                renderAuthView: () => `
                    <div class="auth-container">
                        <div class="auth-modal glass-premium">
                            <div class="text-center mb-8">
                                <div class="w-20 h-20 mx-auto rounded-full flex items-center justify-center bg-gradient-to-br from-primary-azure to-primary-royal mb-4 shadow-premium">
                                    <i class="fas fa-shield-alt text-3xl text-white"></i>
                                </div>
                                <h2 class="text-3xl font-bold text-white mb-2">Secure Access Portal</h2>
                                <p class="text-text-muted">Authenticate to enter the GECAN™ Karavan Global Settlement Layer</p>
                            </div>
                            <form id="auth-form" class="space-y-6">
                                <input type="text" id="karavan-id" class="form-input" placeholder="Enter your Karavan ID" required>
                                <input type="password" id="password" class="form-input" placeholder="Enter your password" required>
                                <button type="submit" class="btn-gold w-full py-3 rounded-lg text-lg"><i class="fas fa-key mr-2"></i>Authenticate & Enter</button>
                            </form>
                        </div>
                    </div>`,
                
                renderRoleSelectView: () => `...`, // This will be a large function, same for others
                
                startHoloStream: () => {
                    const track = document.getElementById('holo-track');
                    if (!track || !AppState.marketData.rates.length) return;
                    const items = AppState.marketData.rates.filter(r => r.status !== 'API ERR').map(rate => `<div class="holo-item"><span class="text-white font-bold">${rate.baseAsset}/${rate.quoteAsset}</span><span class="ml-2 text-green-400">${parseFloat(rate.price).toFixed(4)}</span></div>`).join('');
                    const content = items.repeat(5);
                    track.innerHTML = content + content; // Duplicate for seamless looping
                },

                // Other UI functions here...
                renderRoleSelectView: () => `...`,
                renderTransactionWizard: () => `...`,
                renderWizardStep: (stepId, title, icon) => `...`,
                renderStepContent: (stepId) => `...`,
                isStepDisabled: (stepId) => `...`,
                renderTransactionTracker: () => `...`,
                renderLPDashboard: () => `...`,
                renderAddBeneficiaryModal: () => `...`,
                toggleBankDetails: () => `...`,
            };

            // Initialize
            Logic.init();

        })();
    </script>
</body>
</html>
